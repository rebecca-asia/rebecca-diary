# ユースケース一覧

## 1. ユースケース図

```
┌─────────────────────────────────────────────────────────┐
│                 Rebecca's Diary Website                  │
│                                                         │
│  ┌──────────────────┐    ┌───────────────────────┐      │
│  │ UC-001           │    │ UC-002                │      │
│  │ 日記タイムライン  │    │ 日記エントリ詳細      │      │
│  │ を閲覧する       │───→│ を閲覧する            │      │
│  └──────────────────┘    └───────────────────────┘      │
│           ↑                                              │
│           │              ┌───────────────────────┐      │
│  ┌────┐   │              │ UC-003                │      │
│  │閲覧│───┘              │ レスポンシブ表示で     │      │
│  │ 者 │────────────────→│ 閲覧する              │      │
│  └────┘                  └───────────────────────┘      │
│                                                         │
│  ┌────┐  ┌──────────────────┐  ┌─────────────────────┐  │
│  │管理│─→│ UC-010           │  │ UC-011              │  │
│  │ 者 │  │ 日記エントリを   │  │ エントリ生成を      │  │
│  │    │─→│ 追加する         │  │ プレビューする      │  │
│  └────┘  └────────┬─────────┘  └─────────────────────┘  │
│                   │                      ↑               │
│                   │   ┌──────────────────┘               │
│                   ↓   │                                  │
│          ┌──────────────────┐  ┌─────────────────────┐  │
│          │ UC-012           │  │ UC-013              │  │
│          │ Markdownソースを │  │ index.htmlに        │  │
│          │ 読み込む         │  │ エントリを挿入する  │  │
│          └──────────────────┘  └─────────────────────┘  │
│                                                         │
│          ┌──────────────────┐  ┌─────────────────────┐  │
│  ┌────┐  │ UC-020           │  │ UC-021              │  │
│  │管理│─→│ 開発サーバーで   │─→│ スタイルを          │  │
│  │ 者 │  │ 動作確認する     │  │ 編集する            │  │
│  └────┘  └──────────────────┘  └─────────────────────┘  │
│                                                         │
└─────────────────────────────────────────────────────────┘
```

## 2. ユースケース一覧

### 閲覧系（閲覧者）

| ID | ユースケース名 | アクター | 優先度 | 関連要件 |
|----|--------------|---------|--------|---------|
| UC-001 | 日記タイムラインを閲覧する | 閲覧者 | 必須 | F-001, F-003, F-020 |
| UC-002 | 日記エントリの詳細を閲覧する | 閲覧者 | 必須 | F-002 |
| UC-003 | モバイル端末でレスポンシブ表示で閲覧する | 閲覧者 | 必須 | F-040, F-041, F-042 |
| UC-004 | ダークテーマで快適に閲覧する | 閲覧者 | 必須 | F-010, F-011, F-012 |
| UC-005 | アニメーション演出を体験する | 閲覧者 | 推奨 | F-030, F-031, F-032 |

### 管理系（管理者）

| ID | ユースケース名 | アクター | 優先度 | 関連要件 |
|----|--------------|---------|--------|---------|
| UC-010 | 日記エントリを追加する | 管理者 | 必須 | — |
| UC-011 | エントリ生成をプレビューする（dry-run） | 管理者 | 推奨 | — |
| UC-012 | 特定日付の日記エントリを生成する | 管理者 | 必須 | — |
| UC-013 | index.htmlにエントリを自動挿入する | update_diary.py | 必須 | — |
| UC-020 | 開発サーバーで動作確認する | 管理者 | 必須 | NF-003 |
| UC-021 | スタイル（CSS）を編集する | 管理者 | 任意 | — |
| UC-022 | コンテンツ（HTML）を直接編集する | 管理者 | 任意 | — |

## 3. ユースケース詳細

---

### UC-001: 日記タイムラインを閲覧する

| 項目 | 内容 |
|------|------|
| アクター | 閲覧者 |
| 事前条件 | ウェブサイトがデプロイされている |
| 事後条件 | 日記エントリが新しい順にタイムライン形式で表示される |
| 関連エンティティ | E-001, E-004, E-002 |

**基本フロー:**
1. 閲覧者がウェブサイトのURLにアクセスする
2. システムがindex.htmlを返す
3. ヘッダー（タイトル・マスコット画像）が表示される
4. タイムラインが縦方向に表示される（左側に接続線）
5. 日記エントリがフェードインアニメーションで順次表示される
6. エントリは新しい日付順に上から並ぶ

**代替フロー:**
- 5a. デスクトップ表示の場合、エントリが左右交互に配置される
- 5b. モバイル表示の場合、エントリが左寄せで縦一列に並ぶ

---

### UC-002: 日記エントリの詳細を閲覧する

| 項目 | 内容 |
|------|------|
| アクター | 閲覧者 |
| 事前条件 | UC-001が実行済み |
| 事後条件 | エントリの全セクション（Memory / Obsidian）が表示される |
| 関連エンティティ | E-002, E-003 |

**基本フロー:**
1. 閲覧者がタイムライン上の日記エントリカードを確認する
2. エントリ日付（青色）が表示される
3. OpenClawメモリセクション（🧠）が表示される
4. Obsidianデイリーレポートセクション（📝）が表示される
5. 各セクション内の見出し・リスト・テーブル等が構造化表示される

**代替フロー:**
- 3a. OpenClawメモリが存在しない日はそのセクションが省略される
- 4a. Obsidianノートが存在しない日はそのセクションが省略される

---

### UC-005: アニメーション演出を体験する

| 項目 | 内容 |
|------|------|
| アクター | 閲覧者 |
| 事前条件 | ウェブサイトにアクセスしている |
| 事後条件 | CSSアニメーションが正常に動作する |
| 関連エンティティ | E-005, E-007, E-009 |

**基本フロー:**
1. ページ読み込み時、マスコット画像がフロートアニメーションで揺れる
2. タイトル「Rebecca's Diary」がグローアニメーションで輝く
3. 日記エントリがfadeInUpアニメーションで順次出現する
4. エントリカードにホバーすると浮き上がりエフェクトが発生する
5. マスコット画像にホバーすると拡大・回転する

---

### UC-010: 日記エントリを追加する

| 項目 | 内容 |
|------|------|
| アクター | 管理者 |
| 事前条件 | 対象日付のMarkdownファイルが少なくとも1つ存在する |
| 事後条件 | index.htmlに新しいエントリが挿入される |
| 関連エンティティ | E-010, E-011, E-012, E-008, E-013, E-014 |

**基本フロー:**
1. 管理者が `python3 update_diary.py [YYYY-MM-DD]` を実行する
2. スクリプトが日付を検証する（YYYY-MM-DD形式）
3. OpenClawメモリディレクトリからMarkdownファイルを読み込む
4. ObsidianボルトディレクトリからMarkdownファイルを読み込む
5. MarkdownConverterがHTML に変換する（見出し・リスト・テーブル・インライン書式）
6. 重複チェック: 同日エントリが既にindex.htmlに存在しないか確認する
7. 挿入マーカーの直後に新エントリHTMLを挿入する
8. 成功ログを出力する

**代替フロー:**
- 2a. 日付形式が不正な場合、エラーメッセージを表示して終了（exit code 1）
- 3a. OpenClawファイルが存在しない場合、スキップしてObsidianのみ処理する
- 4a. Obsidianファイルが存在しない場合、スキップしてOpenClawのみ処理する
- 3a+4a. 両方存在しない場合、警告を表示して終了（exit code 0）
- 6a. 同日エントリが既存の場合、警告を表示してスキップ（exit code 0→false）
- 6b. 挿入マーカーが見つからない場合、エラーを表示して終了（exit code 1）

**例外フロー:**
- E1. index.htmlファイルが存在しない場合、エラーログを出力して終了

---

### UC-011: エントリ生成をプレビューする（dry-run）

| 項目 | 内容 |
|------|------|
| アクター | 管理者 |
| 事前条件 | 対象日付のMarkdownファイルが少なくとも1つ存在する |
| 事後条件 | HTMLが標準出力に表示され、index.htmlは変更されない |
| 関連エンティティ | E-010, E-011, E-012, E-013 |

**基本フロー:**
1. 管理者が `python3 update_diary.py --dry-run [YYYY-MM-DD]` を実行する
2. UC-010 のステップ2〜5と同様に処理する
3. 生成されたHTMLを標準出力に表示する
4. index.htmlは変更しない

---

### UC-020: 開発サーバーで動作確認する

| 項目 | 内容 |
|------|------|
| アクター | 管理者 |
| 事前条件 | Python 3がインストールされている |
| 事後条件 | localhost:8080でサイトが閲覧可能になる |
| 関連エンティティ | E-001, E-008, E-009 |

**基本フロー:**
1. 管理者が `cd src && python3 -m http.server 8080` を実行する
2. 開発サーバーが起動する
3. ブラウザで `http://localhost:8080` にアクセスする
4. サイトの表示・アニメーション・レスポンシブ動作を確認する

## 4. ユースケース × エンティティ マトリクス

| ユースケース | E-001 | E-002 | E-003 | E-004 | E-005 | E-008 | E-009 | E-010 | E-011 | E-012 |
|------------|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
| UC-001 閲覧 | R | R | R | R | R | — | — | — | — | — |
| UC-002 詳細 | — | R | R | — | — | — | — | — | — | — |
| UC-003 レスポンシブ | R | R | — | — | — | — | R | — | — | — |
| UC-004 ダークテーマ | R | — | — | — | — | — | R | — | — | — |
| UC-005 アニメーション | — | — | — | — | R | — | R | — | — | — |
| UC-010 エントリ追加 | — | C | C | — | — | U | — | X | R | R |
| UC-011 プレビュー | — | C | C | — | — | — | — | X | R | R |
| UC-020 動作確認 | R | R | — | — | — | R | R | — | — | — |

**凡例:** R=参照 / C=生成 / U=更新 / X=実行
